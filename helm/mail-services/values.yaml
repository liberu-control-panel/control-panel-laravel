# Default values for mail-services

postfix:
  enabled: true
  image:
    repository: boky/postfix
    tag: v4.0.0
    pullPolicy: IfNotPresent
  
  replicaCount: 2
  
  config:
    hostname: mail.example.com
    domain: example.com
    relayHost: ""
    relayPort: 587
    relayUser: ""
    relayPassword: ""
    messageSizeLimit: 52428800  # 50MB
    
  service:
    type: ClusterIP
    port: 587
    
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 100m
      memory: 128Mi

dovecot:
  enabled: true
  image:
    repository: dovecot/dovecot
    tag: 2.3.21
    pullPolicy: IfNotPresent
  
  replicaCount: 2
  
  config:
    hostname: mail.example.com
    protocols: imap pop3 lmtp
    sslCert: /etc/ssl/certs/dovecot.pem
    sslKey: /etc/ssl/private/dovecot.key
    
  service:
    imap:
      port: 143
      tlsPort: 993
    pop3:
      port: 110
      tlsPort: 995
    lmtp:
      port: 24
      
  persistence:
    enabled: true
    # For managed Kubernetes, use platform-specific storage classes:
    # - AWS EKS: "gp3" (recommended)
    # - Azure AKS: "managed-csi-premium" (for better IOPS)
    # - Google GKE: "pd-ssd" or "pd-balanced"
    # - DigitalOcean DOKS: "do-block-storage"
    storageClass: ""  # Uses cluster default if empty
    size: 20Gi
    
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 100m
      memory: 128Mi

# Shared storage for mail data (requires ReadWriteMany support)
# WARNING: "standard" storage class typically does NOT support ReadWriteMany
# You MUST use a ReadWriteMany-compatible storage class or enable S3 storage below
persistence:
  enabled: true
  # For ReadWriteMany access, use NFS-compatible storage:
  # - AWS EKS: "efs-sc" (EFS CSI driver required - see STORAGE_CLASS_GUIDE.md)
  # - Azure AKS: "azurefile" or "azurefile-premium"
  # - Google GKE: "filestore-nfs" (Filestore CSI driver required)
  # - DigitalOcean DOKS: Use S3-compatible Spaces (enable s3 below) or NFS
  # - Self-hosted: NFS storage class or Longhorn
  # 
  # IMPORTANT: If your cluster doesn't support ReadWriteMany storage,
  # consider using S3-compatible storage (see s3 configuration below)
  storageClass: ""  # MUST be set to RWX-compatible class or left empty to fail fast
  size: 50Gi
  accessMode: ReadWriteMany

# S3-compatible storage configuration for mail data
# Alternative to ReadWriteMany block storage - provides shared access
s3:
  enabled: false
  endpoint: ""
  accessKey: ""
  secretKey: ""
  bucket: ""
  region: "us-east-1"
  usePathStyle: true
  storageClassName: "s3-storage"

# TLS configuration
tls:
  enabled: true
  issuer: letsencrypt-prod
